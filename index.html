<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Webull Market Data</title>
  <style>
    body { font-family: sans-serif; }
    #output { margin-top: 20px; }
    .section { margin-bottom: 10px; }
  </style>
</head>
<body>
  <h1>Webull Market Data</h1>
  <input type="text" id="ticker" placeholder="티커 입력 (예: AAPL)" />
  <button id="fetchData">데이터 가져오기</button>
  
  <div id="output"></div>
  
  <script>
    document.getElementById('fetchData').addEventListener('click', function() {
      const ticker = document.getElementById('ticker').value.trim();
      if (!ticker) {
        alert('티커를 입력하세요.');
        return;
      }
      
      // Webull의 티커 페이지 URL (실제 URL 구조는 Webull 사이트에 따라 다를 수 있습니다)
      const url = `https://www.webull.com/quote/${ticker}`;
      
      // fetch 요청 (CORS 문제로 브라우저에서 직접 요청이 안될 수 있음)
      fetch(url)
        .then(response => {
          if (!response.ok) {
            throw new Error('네트워크 응답이 정상이 아닙니다.');
          }
          return response.text();
        })
        .then(html => {
          // 응답 HTML을 DOMParser로 파싱
          const parser = new DOMParser();
          const doc = parser.parseFromString(html, 'text/html');
          
          // 데이터 추출 (여기서는 가상의 클래스명을 사용)
          function getMarketData(sectionSelector) {
            const section = doc.querySelector(sectionSelector);
            if (section) {
              const price = section.querySelector('.price') ? section.querySelector('.price').innerText : 'N/A';
              const change = section.querySelector('.change') ? section.querySelector('.change').innerText : 'N/A';
              return { price, change };
            }
            return { price: 'N/A', change: 'N/A' };
          }
          
          const preMarket = getMarketData('.pre-market');
          const regular   = getMarketData('.regular');
          const afterHours = getMarketData('.after-hours');
          const night      = getMarketData('.night');
          
          // 결과 출력
          document.getElementById('output').innerHTML = `
            <h2>${ticker.toUpperCase()}</h2>
            <div class="section"><strong>프리장:</strong> 가격: ${preMarket.price}, 등락: ${preMarket.change}</div>
            <div class="section"><strong>본장:</strong> 가격: ${regular.price}, 등락: ${regular.change}</div>
            <div class="section"><strong>애프터장:</strong> 가격: ${afterHours.price}, 등락: ${afterHours.change}</div>
            <div class="section"><strong>나이트장:</strong> 가격: ${night.price}, 등락: ${night.change}</div>
          `;
        })
        .catch(error => {
          console.error('데이터 가져오기 실패:', error);
          document.getElementById('output').innerText = '데이터를 가져오지 못했습니다.';
        });
    });
  </script>
</body>
</html>
