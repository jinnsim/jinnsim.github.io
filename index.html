<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Webull Market Data</title>
  <style>
    body { font-family: sans-serif; }
    #output { margin-top: 20px; }
    .section { margin-bottom: 10px; }
  </style>
</head>
<body>
  <h1>Webull Market Data</h1>
  <input type="text" id="ticker" placeholder="티커 입력 (예: AAPL)" />
  <button id="fetchData">데이터 가져오기</button>
  
  <div id="output"></div>
  
  <script>
    document.getElementById('fetchData').addEventListener('click', function() {
      const ticker = document.getElementById('ticker').value.trim();
      if (!ticker) {
        alert('티커를 입력하세요.');
        return;
      }
      
      // Webull 티커 페이지 URL. (실제 URL 형식은 변경될 수 있음)
      const url = `https://www.webull.com/quote/${ticker}`;
      
      fetch(url)
        .then(response => {
          if (!response.ok) {
            throw new Error('네트워크 응답이 정상이 아닙니다.');
          }
          return response.text();
        })
        .then(html => {
          // HTML 파싱
          const parser = new DOMParser();
          const doc = parser.parseFromString(html, 'text/html');
          
          // 최신 Webull 페이지에서 각 시장 정보를 담은 컨테이너 선택자
          // (예시: 프리장은 .market-pre, 본장은 .market-regular,
          //  애프터장은 .market-after, 나이트장은 .market-night)
          function getMarketData(selector) {
            const section = doc.querySelector(selector);
            if (section) {
              // 가격과 등락 정보가 각각 .price와 .change 요소 내에 있다고 가정
              const price = section.querySelector('.price') ? section.querySelector('.price').innerText.trim() : 'N/A';
              const change = section.querySelector('.change') ? section.querySelector('.change').innerText.trim() : 'N/A';
              return { price, change };
            }
            return { price: 'N/A', change: 'N/A' };
          }
          
          const preMarket = getMarketData('.market-pre');
          const regular   = getMarketData('.market-regular');
          const afterHours = getMarketData('.market-after');
          const night      = getMarketData('.market-night');
          
          document.getElementById('output').innerHTML = `
            <h2>${ticker.toUpperCase()}</h2>
            <div class="section"><strong>프리장:</strong> 가격: ${preMarket.price}, 등락: ${preMarket.change}</div>
            <div class="section"><strong>본장:</strong> 가격: ${regular.price}, 등락: ${regular.change}</div>
            <div class="section"><strong>애프터장:</strong> 가격: ${afterHours.price}, 등락: ${afterHours.change}</div>
            <div class="section"><strong>나이트장:</strong> 가격: ${night.price}, 등락: ${night.change}</div>
          `;
        })
        .catch(error => {
          console.error('데이터 가져오기 실패:', error);
          document.getElementById('output').innerText = '데이터를 가져오지 못했습니다.';
        });
    });
  </script>
</body>
</html>
